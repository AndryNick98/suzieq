service: arpnd
keys:
  - ipAddress
  - oif

show-fields:
  - ipAddress
  - oif
  - macaddr
  - state
  - remote

apply:
  cumulus:
    version: all
    command: ip neigh show
    textfsm: textfsm_templates/linux_ipneigh.tfsm

  linux:
    copy: cumulus

  eos:
    version: all
    command: show arp
    normalize: 'ipV4Neighbors/[
    "hwAddress: macaddr",
    "address: ipAddress",
    "interface: oif",
    "state: state?|reachable",
    "offload: remote?|False",
    ]'

  junos:
    version: all
    command: show arp | display json
    normalize: 'arp-table-information/[0]/arp-table-entry/*/[
    "mac-address/[0]/data: macaddr",
    "ip-address/[0]/data: ipAddress",
    "interface-name/[0]/data: oif",
    "interface-name/[0]/data: origIfname",
    "arp-table-entry-flags: flags",
    "offload: remote?|False",
    ]'
      
