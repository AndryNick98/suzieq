description: Testing unique verb
tests:
  - command: system unique --format=json
    data-directory: tests/data/basic_dual_bgp/parquet-out
    error:
      error: |
        [{"error":"ERROR: Must specify columns with unique"}]
    marks: unique

  - command: system unique --columns='hostname uptime' --format=json
    data-directory: tests/data/basic_dual_bgp/parquet-out
    error:
      error: |
        [{"error":"ERROR: Specify a single column with unique"}]
    marks: unique

  - command: system unique --columns=hostname --format=json
    data-directory: tests/data/basic_dual_bgp/parquet-out
    output: |
      [{"hostname":"edge01","count":1},{"hostname":"exit01","count":1},{"hostname":"exit02","count":1},{"hostname":"internet","count":1},{"hostname":"leaf01","count":1},{"hostname":"leaf02","count":1},{"hostname":"leaf03","count":1},{"hostname":"leaf04","count":1},{"hostname":"server101","count":1},{"hostname":"server102","count":1},{"hostname":"server103","count":1},{"hostname":"server104","count":1},{"hostname":"spine01","count":1},{"hostname":"spine02","count":1}]
    marks: system unique

  - command: system unique --columns=badcolumn --format=json
    data-directory: tests/data/basic_dual_bgp/parquet-out
    output: |
      []
    marks: system unique

  - command: routes unique --columns=prefix --format=json
    data-directory: tests/data/basic_dual_bgp/parquet-out
    xfail:
      reason: 'bug #37'
      error: "Error running command: Overlong 2 byte UTF-8 sequence detected when encoding string\n------------------------------------------------------------\n------------------------------------------------------------\n"
    marks: routes unique

