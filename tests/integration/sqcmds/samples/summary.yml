description: Testing summarize verb
tests:
  - command: bgp summarize --format=json --columns='namespace hostname'
    data-directory: tests/data/multidc/parquet-out
    error:
      error: |
        [{"error":"ERROR: You cannot specify columns with summarize"}]
    marks: bgp summarize error

  - command: bgp summarize --format=json
    data-directory: tests/data/multidc/parquet-out
    output: |
      {"dual-evpn":{"hosts":9,"rows":34,"asn":8,"peerAsn":9,"vrf":{"default":28,"internet-vrf":4,"evpn-vrf":2},"afi-safi":["ipv4","evpn"],"upTimes":["0:00:07","21:20:10","21:16:06"],"v4PfxRx":[2,16,13],"v6PfxRx":[0,0,0],"evpnPfxRx":[0,39,8],"updatesRx":[28,253,113.5],"updatesTx":[28,236,117.0],"downSessions":0},"ospf-ibgp":{"hosts":9,"rows":34,"asn":{"65000":28,"65001":4,"25253":2},"peerAsn":4,"vrf":{"default":28,"internet-vrf":4,"evpn-vrf":2},"afi-safi":["ipv4","evpn"],"upTimes":["6:10:36","1 day, 15:27:58","1 day, 15:27:03"],"v4PfxRx":[0,13,1],"v6PfxRx":[0,0,0],"evpnPfxRx":[0,38,8],"updatesRx":[7,126,16.0],"updatesTx":[5,126,11.5],"downSessions":0}}
    marks: bgp summarize

  - command: bgp summarize --format=json --namespace='dual-evpn'
    data-directory: tests/data/multidc/parquet-out
    output: |
      {"dual-evpn":{"hosts":9,"rows":34,"asn":8,"peerAsn":9,"vrf":{"default":28,"internet-vrf":4,"evpn-vrf":2},"afi-safi":["ipv4","evpn"],"upTimes":["0:00:07","21:20:10","21:16:06"],"v4PfxRx":[2.0,16.0,13.0],"v6PfxRx":[0.0,0.0,0.0],"evpnPfxRx":[0.0,39.0,8.0],"updatesRx":[28.0,253.0,113.5],"updatesTx":[28.0,236.0,117.0],"downSessions":0}}
    marks: bgp summarize filter

  - command: ospf summarize --format=json
    data-directory: tests/data/multidc/parquet-out
    output: |
      [{"ospf-ibgp":7,"ospf-single":8},{"ospf-ibgp":18,"ospf-single":24},{"ospf-ibgp":{"0.0.0.0":18},"ospf-single":{"0.0.0.0":24}},{"ospf-ibgp":{"default":18},"ospf-single":{"default":24}},{"ospf-ibgp":{"full":18},"ospf-single":{"full":24}},{"ospf-ibgp":{"1":18},"ospf-single":{"1":24}},{"ospf-ibgp":8,"ospf-single":8},{"ospf-ibgp":["0 days 00:26:24.562662","0 days 00:26:24.562695","0 days 00:26:24.562695"],"ospf-single":["0 days 00:26:24.445972","0 days 00:26:24.445981","0 days 00:26:24.445975"]},{"ospf-ibgp":[5,5,5],"ospf-single":[4,5,5]},{"ospf-ibgp":[0,0,0],"ospf-single":[0,0,0]}]
    marks: ospf summarize

  - command: ospf summarize --format=json --type=interface
    data-directory: tests/data/multidc/parquet-out
    output: |
      [{"ospf-ibgp":29,"ospf-single":36},{"ospf-ibgp":{"up":29},"ospf-single":{"up":36}},{"ospf-ibgp":{"1":22,"0":7},"ospf-single":{"1":24,"0":12}},{"ospf-ibgp":{"True":22,"False":7},"ospf-single":{"True":24,"False":12}},{"ospf-ibgp":{"0.0.0.0":29},"ospf-single":{"0.0.0.0":36}},{"ospf-ibgp":{"default":29},"ospf-single":{"default":36}},{"ospf-ibgp":{"pointopoint":22,"loopback":7},"ospf-single":{"pointopoint":24,"loopback":8,"broadcast":4}},{"ospf-ibgp":{"":22,"True":7},"ospf-single":{"":26,"True":10}},{"ospf-ibgp":{"False":29},"ospf-single":{"False":36}},{"ospf-ibgp":{"100":22,"10":7},"ospf-single":{"100":24,"10":12}},{"ospf-ibgp":{"10":29},"ospf-single":{"10":36}},{"ospf-ibgp":{"40":29},"ospf-single":{"40":36}},{"ospf-ibgp":{"5":29},"ospf-single":{"5":36}}]
    marks: ospf summarize

  - command: route summarize --format=json
    data-directory: tests/data/multidc/parquet-out
    output: |
      [{"dual-evpn":14,"ospf-ibgp":13,"ospf-single":11},{"dual-evpn":4,"ospf-ibgp":4,"ospf-single":2},{"dual-evpn":293,"ospf-ibgp":195,"ospf-single":100},{"dual-evpn":31,"ospf-ibgp":31,"ospf-single":16},{"dual-evpn":[4,53,19.5],"ospf-ibgp":[0,42,16.0],"ospf-single":[0,13,5.0]},{"dual-evpn":[16,175,51],"ospf-ibgp":[14,131,25],"ospf-single":[0,88,6]},{"dual-evpn":189,"ospf-ibgp":122,"ospf-single":42},{"dual-evpn":20,"ospf-ibgp":16,"ospf-single":0},{"dual-evpn":4,"ospf-ibgp":5,"ospf-single":{"ospf":64,"":19,"kernel":17}},{"dual-evpn":true,"ospf-ibgp":true,"ospf-single":true}]
    marks: routes summarize

  - command: interface summarize --format=json
    data-directory: tests/data/multidc/parquet-out
    output: |
      {"dual-evpn":{"hosts":14,"rows":178,"ifPerHost":[4,23,9.5],"hostsWithL2":7,"hasVxlan":true,"mtu":4,"type":9,"ipV4Addresses":59,"ipV6Addresses":80,"mtOneIpPerInterface":5,"downPortCount":9,"state":{"up":169,"unknown":5,"down":4},"ifChanges":[0,0,0]},"ospf-ibgp":{"hosts":13,"rows":155,"ifPerHost":[0,23,9.0],"hostsWithL2":6,"hasVxlan":true,"mtu":4,"type":9,"ipV4Addresses":55,"ipV6Addresses":73,"mtOneIpPerInterface":4,"downPortCount":9,"state":{"up":146,"unknown":5,"down":4},"ifChanges":[0,0,0]},"ospf-single":{"hosts":14,"rows":96,"ifPerHost":[3,10,9.0],"hostsWithL2":4,"hasVxlan":false,"mtu":{"1500":74,"65536":22},"type":5,"ipV4Addresses":30,"ipV6Addresses":45,"mtOneIpPerInterface":0,"downPortCount":17,"state":{"up":79,"down":12,"unknown":5},"ifChanges":[0,0,0]}}
    marks: interface summarize

  - command: lldp summarize --format=json
    data-directory: tests/data/multidc/parquet-out
    output: |
      [{"dual-evpn":10,"ospf-ibgp":9,"ospf-single":5},{"dual-evpn":40,"ospf-ibgp":36,"ospf-single":16},{"dual-evpn":2,"ospf-ibgp":2,"ospf-single":1},{"dual-evpn":10,"ospf-ibgp":10,"ospf-single":8},{"dual-evpn":11,"ospf-ibgp":11,"ospf-single":8},{"dual-evpn":2,"ospf-ibgp":2,"ospf-single":0}]
    marks: lldp summarize

  - command: evpnVni summarize --format=json
    data-directory: tests/data/multidc/parquet-out
    output: |
      [{"dual-evpn":14,"ospf-ibgp":14},{"dual-evpn":{"104001":6,"24":4,"13":4},"ospf-ibgp":{"104001":6,"24":4,"13":4}},{"dual-evpn":{"L2":8,"L3":6},"ospf-ibgp":{"L2":8,"L3":6}},{"dual-evpn":{"evpn-vrf":14},"ospf-ibgp":{"evpn-vrf":14}},{"dual-evpn":[1,4,4],"ospf-ibgp":[1,4,4]},{"dual-evpn":[2,6,6],"ospf-ibgp":[2,6,6]},{"dual-evpn":{"10.0.0.112":4,"10.0.0.134":4},"ospf-ibgp":{"10.0.0.112":4,"10.0.0.134":4}}]
    marks: evpnVni summarize

  - command: mlag summarize --format=json
    data-directory: tests/data/multidc/parquet-out
    output: |
      [{"dual-evpn":4,"ospf-ibgp":4},{"dual-evpn":{"-":4},"ospf-ibgp":{"-":4}},{"dual-evpn":{"10.0.0.134":2,"10.0.0.112":2},"ospf-ibgp":{"10.0.0.134":2,"10.0.0.112":2}},{"dual-evpn":{"secondary":2,"primary":2},"ospf-ibgp":{"secondary":2,"primary":2}},{"dual-evpn":{"false":4},"ospf-ibgp":{"false":4}},{"dual-evpn":{"0":4},"ospf-ibgp":{"0":4}},{"dual-evpn":{"secondary":2,"primary":2},"ospf-ibgp":{"secondary":2,"primary":2}},{"dual-evpn":{"5":4},"ospf-ibgp":{"5":4}},{"dual-evpn":{"active":4},"ospf-ibgp":{"active":4}},{"dual-evpn":4,"ospf-ibgp":4},{"dual-evpn":{"0":4},"ospf-ibgp":{"0":4}},{"dual-evpn":{"peerlink.4094":4},"ospf-ibgp":{"peerlink.4094":4}},{"dual-evpn":{"-":4},"ospf-ibgp":{"-":4}},{"dual-evpn":{"44:39:39:ff:40:94":2,"44:39:39:ff:40:95":2},"ospf-ibgp":{"44:39:39:ff:40:94":2,"44:39:39:ff:40:95":2}},{"dual-evpn":4,"ospf-ibgp":4},{"dual-evpn":{"169.254.1.1":2,"169.254.1.2":2},"ospf-ibgp":{"169.254.1.1":2,"169.254.1.2":2}},{"dual-evpn":{"NA":4},"ospf-ibgp":{"NA":4}},{"dual-evpn":{"NA":4},"ospf-ibgp":{"NA":4}},{"dual-evpn":{"-":4},"ospf-ibgp":{"-":4}}]
    marks: evpnVni summarize