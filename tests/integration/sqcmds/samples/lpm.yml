description: Testing route lpm
tests:
- command: route lpm --address="10.0.0.12" --namespace=ospf-single --format json
  data-directory: tests/data/multidc/parquet-out/
  marks: route lpm
  output: '[{"namespace": "ospf-single", "hostname": "edge01", "vrf": "default", "prefix":
    "0.0.0.0/0", "nexthopIps": ["192.168.121.1"], "oifs": ["eth0"], "protocol": "",
    "source": "", "metric": 20, "ipvers": 4, "timestamp": 1586402951168}, {"namespace":
    "ospf-single", "hostname": "exit01", "vrf": "default", "prefix": "10.0.0.12/32",
    "nexthopIps": ["10.127.0.8", "10.127.1.8"], "oifs": ["swp1", "swp2"], "protocol":
    "ospf", "source": "", "metric": 20, "ipvers": 4, "timestamp": 1586402951168},
    {"namespace": "ospf-single", "hostname": "exit02", "vrf": "default", "prefix":
    "10.0.0.12/32", "nexthopIps": ["10.127.0.10", "10.127.1.10"], "oifs": ["swp1",
    "swp2"], "protocol": "ospf", "source": "", "metric": 20, "ipvers": 4, "timestamp":
    1586402951168}, {"namespace": "ospf-single", "hostname": "internet", "vrf": "default",
    "prefix": "0.0.0.0/0", "nexthopIps": ["192.168.121.1"], "oifs": ["eth0"], "protocol":
    "", "source": "", "metric": 20, "ipvers": 4, "timestamp": 1586402951168}, {"namespace":
    "ospf-single", "hostname": "leaf01", "vrf": "default", "prefix": "10.0.0.12/32",
    "nexthopIps": ["10.127.0.0", "10.127.1.0"], "oifs": ["swp1", "swp2"], "protocol":
    "ospf", "source": "", "metric": 20, "ipvers": 4, "timestamp": 1586402951168},
    {"namespace": "ospf-single", "hostname": "leaf03", "vrf": "default", "prefix":
    "10.0.0.12/32", "nexthopIps": ["10.127.0.4", "10.127.1.4"], "oifs": ["swp1", "swp2"],
    "protocol": "ospf", "source": "", "metric": 20, "ipvers": 4, "timestamp": 1586402951168},
    {"namespace": "ospf-single", "hostname": "leaf04", "vrf": "default", "prefix":
    "10.0.0.12/32", "nexthopIps": ["10.127.0.6", "10.127.1.6"], "oifs": ["swp1", "swp2"],
    "protocol": "ospf", "source": "", "metric": 20, "ipvers": 4, "timestamp": 1586402951168},
    {"namespace": "ospf-single", "hostname": "server101", "vrf": "default", "prefix":
    "10.0.0.0/8", "nexthopIps": ["172.16.1.1"], "oifs": ["eth1"], "protocol": "",
    "source": "", "metric": 20, "ipvers": 4, "timestamp": 1586402951168}, {"namespace":
    "ospf-single", "hostname": "server102", "vrf": "default", "prefix": "10.0.0.0/8",
    "nexthopIps": ["172.16.2.1"], "oifs": ["eth1"], "protocol": "", "source": "",
    "metric": 20, "ipvers": 4, "timestamp": 1586402951168}, {"namespace": "ospf-single",
    "hostname": "server103", "vrf": "default", "prefix": "10.0.0.0/8", "nexthopIps":
    ["172.16.3.1"], "oifs": ["eth1"], "protocol": "", "source": "", "metric": 20,
    "ipvers": 4, "timestamp": 1586402951168}, {"namespace": "ospf-single", "hostname":
    "server104", "vrf": "default", "prefix": "10.0.0.0/8", "nexthopIps": ["172.16.4.1"],
    "oifs": ["eth1"], "protocol": "", "source": "", "metric": 20, "ipvers": 4, "timestamp":
    1586402951168}, {"namespace": "ospf-single", "hostname": "spine01", "vrf": "default",
    "prefix": "10.0.0.12/32", "nexthopIps": ["10.127.0.3"], "oifs": ["swp2"], "protocol":
    "ospf", "source": "", "metric": 20, "ipvers": 4, "timestamp": 1586402951168},
    {"namespace": "ospf-single", "hostname": "spine02", "vrf": "default", "prefix":
    "10.0.0.12/32", "nexthopIps": ["10.127.1.3"], "oifs": ["swp2"], "protocol": "ospf",
    "source": "", "metric": 20, "ipvers": 4, "timestamp": 1586402951168}]'
- command: route lpm --address='10.0.0.12' --namespace=ospf-single --hostname='server101
    server103' --format json
  data-directory: tests/data/multidc/parquet-out/
  marks: route lpm filter
  output: '[{"namespace": "ospf-single", "hostname": "server101", "vrf": "default",
    "prefix": "10.0.0.0/8", "nexthopIps": ["172.16.1.1"], "oifs": ["eth1"], "protocol":
    "", "source": "", "metric": 20, "ipvers": 4, "timestamp": 1586402951168}, {"namespace":
    "ospf-single", "hostname": "server103", "vrf": "default", "prefix": "10.0.0.0/8",
    "nexthopIps": ["172.16.3.1"], "oifs": ["eth1"], "protocol": "", "source": "",
    "metric": 20, "ipvers": 4, "timestamp": 1586402951168}]'
- command: route lpm --address='10.0.0.12' --namespace=evpn-dual --vrf=evpn-vrf --format
    json
  data-directory: tests/data/multidc/parquet-out/
  marks: route lpm filter
  output: '[]'
- command: route lpm --address='10.0.0.11' --namespace=dual-evpn --vrf=evpn-vrf --format
    json
  data-directory: tests/data/multidc/parquet-out/
  marks: route lpm filter
  output: '[{"namespace": "dual-evpn", "hostname": "exit01", "vrf": "evpn-vrf", "prefix":
    "10.0.0.11/32", "nexthopIps": ["169.254.254.6"], "oifs": ["swp5.3"], "protocol":
    "bgp", "source": "", "metric": 20, "ipvers": 4, "timestamp": 1586402557952}, {"namespace":
    "dual-evpn", "hostname": "exit02", "vrf": "evpn-vrf", "prefix": "10.0.0.11/32",
    "nexthopIps": ["169.254.253.6"], "oifs": ["swp5.3"], "protocol": "bgp", "source":
    "", "metric": 20, "ipvers": 4, "timestamp": 1586402557952}]'
